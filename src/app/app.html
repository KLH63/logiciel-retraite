<div class="container" style="max-width: 820px; margin: 24px auto;">
  <h3 style="margin-bottom: 16px;">Calculette <span style="color:#f97316;">Retraite</span></h3>

  <form [formGroup]="form" (ngSubmit)="calculer()" class="card" style="padding:16px; border:1px solid #e5e7eb; border-radius:12px;">
    <div style="display:grid; grid-template-columns: repeat(2,minmax(0,1fr)); gap:12px;">
      <label>Date de naissance
        <input type="date" formControlName="birthDate" (change)="recalculerRegles()" />
      </label>

      <label>Âge de départ
        <input type="number" formControlName="ageCible" />
      </label>

      <label>Trimestres acquis
        <input type="number" formControlName="trimestres" />
      </label>

      <label>Points complémentaires
        <input type="number" formControlName="points" />
      </label>

      <label>Salaire Annuel Moyen (SAM) €
        <input type="number" formControlName="sam" />
      </label>

      <label>Nombre d'enfants
        <input type="number" formControlName="enfants" />
      </label>
    </div>

    <div style="margin-top:8px; color:#475569; font-size:14px;">
      <b>Âge légal (dérivé)</b> : {{ reglesDerivees.legalAge | number:'1.2-2' }} ans
      — <b>Trimestres requis</b> : {{ reglesDerivees.requiredQuarters }}
    </div>

    <div style="margin-top:12px; display:flex; gap:8px;">
      <button type="submit">Calculer</button>
      <button type="button" (click)="form.reset({birthDate:null,ageCible:64,trimestres:0,points:0,sam:0,enfants:0}); resultat=null; reglesDerivees=regles">Effacer</button>
    </div>
  </form>

  <div *ngIf="resultat" class="card" style="margin-top:12px; padding:16px; border:1px solid #e5e7eb; border-radius:12px;">
    <h4 style="margin-top:0;">Résultat</h4>
    <ul style="line-height:1.8;">
      <li><b>Taux appliqué</b> : {{ (resultat.taux*100) | number:'1.0-2' }} %</li>
      <li><b>Prorata (trimestres/requis)</b> : {{ (resultat.prorata*100) | number:'1.0-2' }} %</li>
      <li><b>Base (annuelle)</b> : {{ fmt(resultat.baseAnnual) }} €</li>
      <li><b>Complémentaire (annuelle)</b> : {{ fmt(resultat.compAnnual) }} €</li>
      <li><b>Total brut</b> : {{ fmt(resultat.gross) }} €</li>
      <li><b>Total net estimé</b> : {{ fmt(resultat.net) }} €</li>
    </ul>
  </div>
</div>
